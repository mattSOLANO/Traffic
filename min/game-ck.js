function preload(){game.load.image("car","car.png"),game.load.image("stopLine","stopLine.png"),game.load.image("green","green.png"),game.load.spritesheet("light","lightSprite.png",20,20,2)}function create(){game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor="#E8ECC7",game.stage.smoothed=!1,car=game.add.sprite(100,200,"car"),game.physics.arcade.enable(car),car2=game.add.sprite(0,200,"car"),game.physics.arcade.enable(car2),car.body.velocity.set(100,0),car2.body.velocity.set(100,0),smartGroup=game.add.group();for(var e=4,a=0;e>a;a++){var t=smartGroup.create(100*(a+1),400,"car");game.physics.arcade.enable(t),t.body.velocity.set(75,0)}stopLine=game.add.sprite(500,200,"stopLine"),light=game.add.button(550,200,"light",changeLight,this,0,0,0)}function update(){var e=stopLine.x-car.x;if(150>e&&e>38)if("stop"==lightState){var a=(stopLine.x-car.x)/100*100-38;car.body.velocity.set(a,0)}else"go"==lightState&&car.body.velocity.set(100,0);var t=car.x-car2.x;if(100>t&&t>38){var o=(car.x-car2.x)/100*100-38;car2.body.velocity.set(o,0)}else t>=100&&car2.body.velocity.set(100,0);smartGroup.forEach(function(e){e.events.onOutOfBounds.add(goodbye,this);var a=stopLine.x-e.x;if(a>40)smartGroup.forEach(function(a){var t=game.physics.arcade.distanceBetween(e,a);if(a.x>e.x&&100>t&&t>0){var o=(a.x-e.x)/100*100-50;e.body.velocity.set(o,0)}});else if(40>=a&&a>10)if("stop"==lightState){var t=(stopLine.x-e.x)/100*100-38;e.body.velocity.set(t,0)}else"go"==lightState&&e.body.velocity.set(100,0)})}function changeLight(){"stop"==lightState?(lightState="go",light.setFrames(1,1,1)):"go"==lightState&&(lightState="stop",light.setFrames(0,0,0))}function goodbye(e){console.log("adios")}var game=new Phaser.Game(800,600,Phaser.AUTO,"phaser-example",{preload:preload,create:create,update:update}),car,car2,smartGroup,stopLine,light,lightState="stop";