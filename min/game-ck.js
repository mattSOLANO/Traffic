function preload(){game.load.image("car","car.png"),game.load.image("stopLine","stopLine.png"),game.load.image("green","green.png"),game.load.spritesheet("light","lightSprite.png",20,20,2)}function create(){game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor="#E8ECC7",game.stage.smoothed=!1,smartGroup=game.add.group(),game.time.events.loop(game.rnd.integerInRange(1e3,3e3),newCar,this),stopLine=game.add.sprite(500,200,"stopLine"),light=game.add.button(550,200,"light",changeLight,this,0,0,0)}function update(){smartGroup.forEach(function(e){e.events.onOutOfBounds.add(goodbye,this);var t=stopLine.x-e.x;if(t>40||0>t)smartGroup.forEach(function(t){var a=game.physics.arcade.distanceBetween(e,t);if(t.x>e.x&&70>=a&&a>0){var o=(a-40)/100*e.speed;e.body.velocity.set(o,0)}else t.x>e.x&&a>70&&e.body.velocity.set(e.speed,0)});else if(70>=t&&t>0)if("stop"==lightState){var a=(t-40)/100*e.speed;e.body.velocity.set(a,0)}else"go"==lightState&&e.body.velocity.set(e.speed,0)})}function changeLight(){"stop"==lightState?(lightState="go",light.setFrames(1,1,1)):"go"==lightState&&(lightState="stop",light.setFrames(0,0,0))}function goodbye(e){}function newCar(){var e=smartGroup.create(0,200,"car"),t=game.rnd.integerInRange(100,200);game.physics.arcade.enable(e),e.checkWorldBounds=!0,e.outOfBoundsKill=!0,e.speed=t,e.body.velocity.set(t,0),e.events.onOutOfBounds.add(goodbye,this)}var game=new Phaser.Game(800,600,Phaser.AUTO,"phaser-example",{preload:preload,create:create,update:update}),car,car2,smartGroup,stopLine,light,lightState="stop";