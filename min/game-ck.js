function preload(){game.load.image("car","car.png"),game.load.image("carVert","car_vert.png"),game.load.image("stopLine","stopLine.png"),game.load.image("green","green.png"),game.load.spritesheet("light","lightSprite.png",20,20,2)}function create(){game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor="#E8ECC7",game.stage.smoothed=!1,smartGroup=game.add.group(),smartGroup2=game.add.group(),game.time.events.loop(game.rnd.integerInRange(2e3,3e3),newCar,this),game.time.events.loop(game.rnd.integerInRange(2e3,3e3),newCar2,this),stopLine=game.add.sprite(500,200,"stopLine"),light=game.add.button(550,200,"light",changeLight,this,0,0,0),text=game.add.text(700,25,theScore,style)}function update(){smartGroup.forEachAlive(function(e){var t=stopLine.x-e.x;if(t>40||0>t)smartGroup.forEachAlive(function(t){var a=game.physics.arcade.distanceBetween(e,t);if(t.x>e.x&&70>=a&&a>0){var o=(a-40)/100*e.speed;e.body.velocity.set(o,0)}else t.x>e.x&&a>70&&e.body.velocity.set(e.speed,0)});else if(70>=t&&t>0)if("stop"==lightState){var a=(t-40)/100*e.speed;e.body.velocity.set(a,0)}else"go"==lightState&&e.body.velocity.set(e.speed,0)}),smartGroup2.forEachAlive(function(e){var t=stopLine.y-e.y;if(t>40||0>t)smartGroup2.forEachAlive(function(t){var a=game.physics.arcade.distanceBetween(e,t);if(t.y>e.y&&70>=a&&a>0){var o=(a-40)/70*e.speed;e.body.velocity.set(0,o)}else t.y>e.y&&a>70&&e.body.velocity.set(0,e.speed)});else if(70>=t&&t>0)if("go"==lightState){var a=(t-40)/100*e.speed;e.body.velocity.set(0,a)}else"stop"==lightState&&e.body.velocity.set(0,e.speed)})}function changeLight(){"stop"==lightState?(lightState="go",light.setFrames(1,1,1)):"go"==lightState&&(lightState="stop",light.setFrames(0,0,0))}function goodbye(e){theScore++,text.setText(theScore)}function newCar(){var e=smartGroup.create(0,200,"car"),t=game.rnd.integerInRange(100,200);game.physics.arcade.enable(e),e.anchor.setTo(.5,.5),e.checkWorldBounds=!0,e.outOfBoundsKill=!0,e.speed=t,e.body.velocity.set(t,0),e.events.onOutOfBounds.add(goodbye,this)}function newCar2(){var e=smartGroup2.create(550,0,"carVert"),t=game.rnd.integerInRange(100,200);game.physics.arcade.enable(e),e.anchor.setTo(.5,.5),e.checkWorldBounds=!0,e.outOfBoundsKill=!0,e.speed=t,e.body.velocity.set(0,t),e.events.onOutOfBounds.add(goodbye,this)}var game=new Phaser.Game(800,600,Phaser.AUTO,"phaser-example",{preload:preload,create:create,update:update}),smartGroup,smartGroup2,stopLine,light,style={font:"20px Arial",fill:"#373737",align:"center"},theScore=0,text,lightState="stop";